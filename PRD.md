## MVP PRD 骨架：運動攝影平台（暫名 SportSnap）

## 1. 產品簡介與背景

- **產品定位**

  - 一個專注於「運動賽事」的線上攝影平台，連結「攝影師」與「參賽者 / 照片購買者」，提供瀏覽、購買與下載賽事照片的服務。
  - 長期目標是成為「提供賽事主辦單位的運動攝影 SaaS 平台」，短期以 B2C / B2B2C 模式驗證市場（平台 + 攝影師）。

- **問題與痛點**

  - 參賽者：賽後很難系統化地找到自己照片（分散在粉專、相簿、雲端、各攝影師頁面）。
  - 攝影師：缺乏專門面向運動賽事的販售平台，也缺乏統一的曝光與收益結算機制。
  - 主辦單位（長期）：缺乏一個可以「統一管理賽事影像資產」與「提供參賽者加值服務」的平台。

- **解決方案（MVP）**
  - 提供一個網站（PC + RWD），讓：
    - 參賽者能夠依賽事 → 攝影師合輯 → 照片，快速找到並購買個人賽事照片。
    - 攝影師能夠輕鬆上傳、管理賽事照片，並查看收益與下載數。
    - 平台管理者能建立賽事、管理帳號與查看訂單。

---

## 2. 產品目標與成功指標（MVP）

- **MVP 目標（6–12 個月）**

  - 成功完成至少 **1–3 場實際賽事的導入與測試**。
  - 驗證：參賽者願意在線上購買賽事照片，攝影師願意透過平台販售。

- **成功指標（可再細化數字）**
  - 每場賽事：
    - 至少 X 位攝影師上傳照片（預期 3+）。
    - 總上傳照片量：5,000 ~ 20,000 張。
    - 付費下載數 / 轉換率達到預期（例如：至少 50 筆付費訂單）。
  - 攝影師滿意度：願意持續使用平台參與下一場賽事（回流率）。

> （這裡的 X / 50 可以之後依實際情況填入具體數字）

---

## 3. 目標市場與使用者

- **地區與市場**

  - 第一階段：台灣 / 亞洲地區的各類運動賽事（路跑、馬拉松、公路車、越野車、鐵人三項等）。

- **使用者角色**

  - **Buyer（參賽者 / 照片購買者）**

    - 賽事參與者，賽後希望取得自己的動態照片做紀念與分享。
    - 可能由賽事主辦單位或攝影師引導進入平台。

  - **Photographer（攝影師）**

    - 專業或半專業攝影師，長期拍攝運動賽事，期待穩定的曝光與收益來源。
    - 需要方便的上傳工具與清楚的收益統計。

  - **Admin（平台管理者 / 之後可延伸為主辦方管理者）**
    - 現階段由平台方扮演，負責賽事與帳號管理、審核攝影師、查看訂單與統計報表。
    - 未來可區分出 `organizer_admin`（主辦方管理者）角色。

---

## 4. MVP 範圍（Scope）

### 4.1 In Scope（這一版一定要做）

- **平台共用基礎**

  - 網頁版（PC + RWD），單一站點，使用角色與 RBAC 控管不同後台。
  - 帳號系統：註冊、登入、登出、修改密碼。
  - 基本 RBAC：`buyer` / `photographer` / `admin` 權限區隔。

- **Buyer 前台**

  - 賽事列表：依關鍵字、地區、時間搜尋賽事。
  - 賽事內頁：顯示該賽事下的攝影師合輯列表。
  - 攝影師合輯頁：縮圖瀏覽、依「參賽編號」搜尋照片（姓名搜尋可延後）。
  - 購物車：加入 / 移除照片、顯示總金額。
  - 結帳流程：與第三方支付 / 信用卡金流串接。
  - 購買紀錄與圖庫：訂單列表、可下載照片列表（含下載連結）。
  - 帳號中心：個人資料修改、密碼修改（Email 驗證可第二階段）。

- **Photographer 後台**

  - 攝影師註冊 / 登入（可與一般帳號共用，角色由 admin 標記或審核）。
  - Dashboard：已參與的賽事列表、每場簡易下載 / 收益統計。
  - 賽事 & 合輯管理：選擇賽事、建立合輯（名稱、描述、定價）。
  - 批次上傳照片：拖拉上傳、多張同時上傳。
  - 上傳浮水印（PNG）：做為該攝影師照片預覽的浮水印來源。
  - 收益總覽：顯示累積銷售金額、平台分成比例（暫不實作自動提款）。

- **Admin 後台（平台管理）**

  - 登入管理後台。
  - 賽事管理：建立 / 編輯 / 關閉賽事（名稱、日期、地點、簡介、所屬 Organizer 預留欄位）。
  - 攝影師帳號管理：列表、審核 / 啟用 / 停用攝影師。
  - 使用者查詢：基本 buyer 帳號列表與查詢。
  - 訂單與報表：
    - 訂單列表（依賽事 / 攝影師 / 時間篩選）。
    - 匯出報表（CSV）供人工結算攝影師收益。

- **金流與收益**

  - 前台串接第三方支付 / 信用卡收款（實際服務商 TBD）。
  - 收入分潤模型：平台 20% / 攝影師 80%（可設定為全域預設值）。
  - 實際款項拆分暫以「平台收款 → 產生報表 → 人工匯款給攝影師」方式進行。

- **檔案與圖庫（Cloudflare R2）**
  - 使用 Cloudflare R2 儲存原始照片與縮圖。
  - 產生帶浮水印的預覽圖（使用攝影師上傳的浮水印）。
  - 提供付費使用者下載用的高畫質版本（有無浮水印的策略可再決定）。
  - 設計清理策略（未購買照片 90 天清理，已購買照片保留策略 TBD）。

### 4.2 Out of Scope（MVP 明確不做）

- AI 臉部辨識與「上傳自拍自動找出照片」功能。
- 主辦方專屬 SaaS 介面（`organizer_admin` 後台與白標方案）。
- 自動化分潤發放（自動匯款 / payout API）。
- 手機 App（iOS / Android 原生）。
- 進階報表 / 數據分析儀表板。
- 多語系（初期以繁體中文為主）。

---

## 5. 核心使用流程（User Flows / 高層級）

### 5.1 Buyer：購買賽事照片流程

1. 進入首頁 / 賽事列表頁。
2. 透過關鍵字 / 地區 / 日期搜尋，找到參加的賽事。
3. 點入賽事頁 → 查看該場賽事的攝影師合輯列表。
4. 選擇某位攝影師合輯 → 瀏覽縮圖，使用「參賽編號」搜尋照片。
5. 將想購買的照片加入購物車。
6. 前往結帳：系統要求登入 / 註冊（若尚未登入）。
7. 選擇支付方式 → 完成付款。
8. 付款完成後，導向「訂單詳情 / 圖庫」，可立即下載已購買照片。
9. 之後可在「帳號中心 → 購買紀錄 / 圖庫」再次下載。

### 5.2 Photographer：上傳與管理賽事照片

1. 攝影師註冊帳號，並由 Admin 審核為 `photographer` 角色。
2. 登入後進入「攝影師 Dashboard」。
3. 在「帳號設定」上傳個人浮水印（PNG）。
4. 在 Dashboard 中選擇參與的賽事，或由 Admin 指派。
5. 在該賽事下建立一個或多個「攝影合輯」（設定名稱、描述、定價）。
6. 進入合輯，批次上傳照片。
7. 系統自動處理：產生縮圖＋套用浮水印。
8. 攝影師可查看每場賽事的銷售總額、下載次數與平台分潤比例。

### 5.3 Admin：賽事與帳號管理

1. Admin 登入管理後台。
2. 建立新賽事（填寫名稱、日期、地點，未來可選擇 Organizer）。
3. 審核攝影師申請，核准其角色與權限。
4. 在訂單管理頁中，查看每場賽事 / 攝影師的訂單與銷售金額。
5. 產生並匯出收益報表（依賽事 / 攝影師），作為人工匯款依據。

---

## 6. 關鍵功能需求（概要）

> 這裡只寫概要，之後可以進一步拆成 User Story（例如：「身為一個 buyer，我希望…」）。

### 6.1 Buyer 端

- 賽事搜尋與列表顯示。
- 賽事內頁與攝影師合輯列表。
- 合輯內照片瀏覽與依參賽編號搜尋。
- 購物車管理與結帳流程。
- 帳號註冊 / 登入 / 修改密碼。
- 購買紀錄與下載中心（圖庫）。

### 6.2 Photographer 端

- 攝影師身分註冊 / 審核。
- 賽事清單與合輯管理。
- 批次上傳照片、照片列表管理。
- 浮水印上傳與套用。
- 收益與下載統計 Dashboard（簡易版即可）。

### 6.3 Admin 後台

- 賽事 CRUD。
- 使用者列表與攝影師審核。
- 訂單查詢、篩選、匯出報表。
- 全域分潤比例設定（平台 / 攝影師，預留主辦欄位）。

---

## 7. 商業規則與金流

- **分潤規則（MVP）**

  - 平台抽成：預設 20%。
  - 攝影師分潤：預設 80%。
  - 主辦單位分潤：預留欄位，目前為 0 或不啟用。

- **支付流程**

  - 使用第三方支付或信用卡服務（供應商 TBD）。
  - 一張訂單可包含多張照片，可能來自同一攝影師或多位攝影師（此點可再決定）。
  - 支付完成後，建立訂單與明細（Order / OrderItem），並記錄對應的分潤金額。

- **結算流程（MVP）**
  - 平台統一收款。
  - Admin 後台導出「每位攝影師於某期間的應收金額」報表。
  - 實際匯款由平台使用傳統金融工具完成（線下流程）。

---

## 8. 圖片儲存與保留策略

- **儲存方案**

  - 使用 Cloudflare R2 作為物件儲存。
  - 儲存項目：
    - 原始照片檔。
    - 有浮水印的預覽縮圖。
    - 專用下載檔（高畫質，有無浮水印策略 TBD）。
    - 攝影師浮水印檔（PNG）。

- **保留與清理策略（暫定，需政策確認）**
  - 未被購買的照片：
    - 賽事結束後 N 天（例如 90 天）進行自動清理（刪除 R2 檔案與相關索引）。
  - 已被購買的照片：
    - 至少保留一段時間（例如 1 ～ 2 年），具體年限 TBD，需列入使用條款與隱私政策。

---

## 9. 權限與安全（RBAC 概要）

- **角色**

  - `buyer`：只能存取前台與自己的帳號 / 訂單 / 圖庫。
  - `photographer`：可存取攝影師後台、自己建立的合輯與統計。
  - `admin`：可管理賽事、使用者、訂單與分潤設定。

- **技術方向（不綁技術棧，供後端設計參考）**
  - 使用 `users` / `roles` / `user_roles` 表管理角色關係。
  - 登入後產生 JWT 或 session，內含 userId 與 roles。
  - 所有後端 API 由 middleware 檢查角色與資源擁有權。

---

## 10. 非功能需求（NFR）

- **效能**

  - 一場賽事照片量預期 5,000 ~ 20,000 張，需要良好的分頁與快取策略。
  - 圖片以 CDN 加速，避免大流量時造成後端壓力。

- **可用性**

  - 前端介面以「簡約、直覺」為主，減少學習成本，參考一般電商使用模式。

- **擴充性**

  - 資料模型預留 Organizer / 主辦方，方便日後延伸成 SaaS。
  - RBAC 設計可支援新增角色（如 `organizer_admin`）。

- **安全**
  - 密碼加鹽雜湊儲存。
  - 重要操作（登入、結帳）需考慮基本防護（CSRF / XSS / SQL injection 等）。

---

## 11. 風險與假設

- **假設**

  - 賽事主辦單位願意配合在賽事對參賽者宣傳平台連結。
  - 攝影師願意在平台規則下接受收益分潤模式。

- **風險（舉例）**
  - 參賽者付費意願低 → 需要透過定價策略 / 活動增加誘因。
  - 攝影師上傳流程不順暢 → 可能導致供給不足。
  - 金流 / 法規相關要求（發票、稅務）需依台灣法規調整。

---

## 12. 版本與里程碑（可依實際調整）

- **MVP v0.1（內部 Demo）**

  - 基本 DB 與 API 雛形、簡易前端頁面，完成基本 flow 串聯（無正式金流）。

- **MVP v0.5（封閉測試）**

  - 串上金流 Sandbox、照片上傳與瀏覽基本 OK，可邀請少數攝影師內測。

- **MVP v1.0（第一場實戰賽事）**
  - 正式金流、穩定上傳與下載、基本報表與人工結算機制到位。

---

## 13. 技術架構與資料庫設計 (Technical Specs)

### 13.1 Tech Stack
- **Frontend**: Nuxt.js (Vue 3) + Nuxt UI + Tailwind CSS + SCSS.
- **Backend**: Node.js (Express) REST API.
- **Database**: PostgreSQL.
- **Storage**: Cloudflare R2.
- **Payment**: Stripe (MVP 快速驗證)，保留介面未來介接 NewebPay/ECPay。

### 13.2 Database Schema (Preliminary)
- **Users**: `id`, `email`, `password_hash`, `role` (buyer/photographer/admin), `created_at`
- **Events**: `id`, `name`, `date`, `location`, `status`, `organizer_id` (nullable)
- **Albums**: `id`, `event_id`, `photographer_id`, `name`, `description`, `status`
- **Photos**: `id`, `album_id`, `r2_key` (original), `r2_thumbnail_key`, `filename`, `bib_numbers` (Array), `price`, `status`
- **Orders**: `id`, `user_id`, `total_amount`, `currency`, `status` (pending/paid/failed), `payment_provider`, `transaction_id`
- **OrderItems**: `id`, `order_id`, `photo_id`, `price_at_purchase`
